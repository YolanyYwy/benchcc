# ğŸ“¦ Tau2-CL é¡¹ç›®å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ ¸å¿ƒå®ç°

#### 1.1 æŒç»­å­¦ä¹ æ¡†æ¶
- âœ… **Orchestrator** (`src/tau2/continual_learning/orchestrator.py`)
  - å®éªŒç®¡ç†å’Œåè°ƒ
  - å¤šdomainä»»åŠ¡è°ƒåº¦
  - è¯„ä¼°å’Œæ£€æŸ¥ç‚¹ä¿å­˜

#### 1.2 Agentå®ç°
- âœ… **ICL-ER Agent** (`src/tau2/continual_learning/agents/icl_experience_replay.py`)
  - ä¸Šä¸‹æ–‡å­¦ä¹  + ç»éªŒå›æ”¾
  - è®°å¿†ç¼“å†²ç®¡ç†
  - åŠ¨æ€ç¤ºä¾‹é€‰æ‹©

- âœ… **Prompt Strategy Agent** (`src/tau2/continual_learning/agents/prompt_strategy.py`)
  - æç¤ºç­–ç•¥è¿›åŒ–
  - å…ƒå­¦ä¹ ä¼˜åŒ–

- âœ… **Baseline Agent** (`src/tau2/continual_learning/agents/base.py`)
  - æ— CLçš„åŸºçº¿å¯¹æ¯”

#### 1.3 Curriculumç­–ç•¥
- âœ… **Sequential** (`src/tau2/continual_learning/curriculum/sequential.py`)
  - é¡ºåºå­¦ä¹ 

- âœ… **Interleaved** (`src/tau2/continual_learning/curriculum/interleaved.py`)
  - äº¤é”™å­¦ä¹ 

- âœ… **Difficulty-based** (`src/tau2/continual_learning/curriculum/difficulty_based.py`)
  - åŸºäºéš¾åº¦çš„è¯¾ç¨‹

#### 1.4 Memoryç®¡ç†
- âœ… **Experience Buffer** (`src/tau2/continual_learning/memory/buffer.py`)
  - å¤šç§é‡‡æ ·ç­–ç•¥ï¼ˆUniform, Reward-weighted, Diversityç­‰ï¼‰
  - è‡ªåŠ¨å®¹é‡ç®¡ç†

#### 1.5 è¯„ä¼°æŒ‡æ ‡
- âœ… **CL Metrics** (`src/tau2/continual_learning/metrics/metrics.py`)
  - Average Accuracy
  - Forgetting Rate
  - Forward/Backward Transfer
  - Per-domain metrics

#### 1.6 æ•°æ®ç”Ÿæˆ
- âœ… **Data Validator** (`src/tau2/continual_learning/data_generation/validator.py`)
  - ä»»åŠ¡æ•°æ®éªŒè¯
  - æ ¼å¼æ£€æŸ¥

- âœ… **Split Generator** (`src/tau2/continual_learning/data_generation/generator.py`)
  - è®­ç»ƒ/æµ‹è¯•åˆ’åˆ†
  - å¤šç­–ç•¥æ”¯æŒ

### 2. CLIå·¥å…·

#### 2.1 ä¸»è¦å‘½ä»¤
```bash
tau2 cl-run                  # è¿è¡ŒCLå®éªŒ
tau2 cl-analyze              # åˆ†æå®éªŒç»“æœ
tau2 cl-info                 # æ˜¾ç¤ºCLæ¨¡å—ä¿¡æ¯
tau2 cl-validate-data        # éªŒè¯ä»»åŠ¡æ•°æ®
tau2 cl-data-requirements    # æ£€æŸ¥æ•°æ®éœ€æ±‚
tau2 cl-generate-splits      # ç”Ÿæˆæ•°æ®åˆ’åˆ†
```

æ‰€æœ‰å‘½ä»¤éƒ½å·²åœ¨ `src/tau2/cli.py` ä¸­æ³¨å†Œå¹¶å¯ç”¨ã€‚

### 3. è¾…åŠ©å·¥å…·

#### 3.1 å®éªŒç®¡ç†è„šæœ¬
- âœ… **quick_experiment.py** (`scripts/quick_experiment.py`)
  - å¿«é€Ÿæµ‹è¯•
  - å®Œæ•´å¯¹æ¯”å®éªŒ
  - ä»»åŠ¡æ¨¡æ¿ç”Ÿæˆ

- âœ… **compare_experiments.py** (`scripts/compare_experiments.py`)
  - å¤šå®éªŒå¯¹æ¯”
  - å¯è§†åŒ–ç”Ÿæˆ
  - CSVå¯¼å‡º

#### 3.2 æ¼”ç¤ºè„šæœ¬
- âœ… **demo_commands.sh** - Linux/Macæ¼”ç¤ºè„šæœ¬
- âœ… **demo_commands.bat** - Windowsæ¼”ç¤ºè„šæœ¬

### 4. æ–‡æ¡£

#### 4.1 ç”¨æˆ·æ–‡æ¡£
- âœ… **å¿«é€Ÿå¼€å§‹æŒ‡å—.md** - æ–°æ‰‹å®Œæ•´æ•™ç¨‹
- âœ… **CLå®éªŒå¿«é€Ÿå¼€å§‹.md** - å¿«é€Ÿå‚è€ƒæ‰‹å†Œ
- âœ… **continual_learning_workflow.md** - å®Œæ•´å·¥ä½œæµç¨‹æ–‡æ¡£

#### 4.2 æŠ€æœ¯æ–‡æ¡£
æ‰€æœ‰æ ¸å¿ƒæ¨¡å—éƒ½åŒ…å«è¯¦ç»†çš„docstringå’Œç±»å‹æ³¨è§£ã€‚

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æœ€ç®€å•çš„å¼€å§‹æ–¹å¼

**æ–¹å¼1ï¼šä¸€é”®æµ‹è¯•**
```bash
python scripts/quick_experiment.py quick-test --domain airline --num-tasks 10
```

**æ–¹å¼2ï¼šä½¿ç”¨æ¼”ç¤ºè„šæœ¬**
```bash
# Windows
demo_commands.bat

# Linux/Mac
bash demo_commands.sh
```

**æ–¹å¼3ï¼šæ‰‹åŠ¨è¿è¡Œ**
```bash
# 1. éªŒè¯æ•°æ®
tau2 cl-validate-data data/tau2/domains/airline/tasks.json

# 2. ç”Ÿæˆåˆ’åˆ†
tau2 cl-generate-splits --domains airline --strategy sequential

# 3. è¿è¡Œå®éªŒ
tau2 cl-run \
    --name my_experiment \
    --domains airline \
    --curriculum sequential \
    --agent-type icl_er \
    --num-tasks 20 \
    --output-dir ./experiments/my_experiment

# 4. åˆ†æç»“æœ
tau2 cl-analyze experiments/my_experiment/results.json
```

---

## ğŸ“Š å®éªŒè¾“å‡º

æ¯ä¸ªå®éªŒä¼šç”Ÿæˆï¼š

```
experiments/your_experiment/
â”œâ”€â”€ config.json                 # å®éªŒé…ç½®
â”œâ”€â”€ results.json                # å®Œæ•´ç»“æœï¼ˆåŒ…å«æ‰€æœ‰æŒ‡æ ‡ï¼‰
â”œâ”€â”€ metrics/
â”‚   â”œâ”€â”€ accuracy_curve.png      # å­¦ä¹ æ›²çº¿
â”‚   â”œâ”€â”€ forgetting_matrix.png   # é—å¿˜çŸ©é˜µ
â”‚   â””â”€â”€ performance_matrix.png  # æ€§èƒ½çƒ­å›¾
â”œâ”€â”€ agent_state/
â”‚   â”œâ”€â”€ final_state.json        # æœ€ç»ˆagentçŠ¶æ€
â”‚   â””â”€â”€ memory_buffer.json      # è®°å¿†ç¼“å†²å†…å®¹
â””â”€â”€ logs/
    â””â”€â”€ experiment.log          # è¯¦ç»†è¿è¡Œæ—¥å¿—
```

---

## ğŸ¯ ä¸»è¦åŠŸèƒ½ç‰¹æ€§

### 1. å¤šç§Agentç­–ç•¥
- **ICL-ER**: ä¸Šä¸‹æ–‡å­¦ä¹  + ç»éªŒå›æ”¾
- **Prompt Strategy**: æç¤ºç­–ç•¥è¿›åŒ–
- **Baseline**: åŸºçº¿å¯¹æ¯”

### 2. çµæ´»çš„Curriculum
- **Sequential**: å…ˆå­¦å®Œdomain Aå†å­¦domain B
- **Interleaved**: domain Aå’ŒBäº¤æ›¿å­¦ä¹ 
- **Difficulty-based**: ä»æ˜“åˆ°éš¾é€æ­¥å­¦ä¹ 

### 3. æ™ºèƒ½Memoryç®¡ç†
- **Uniform**: å‡åŒ€é‡‡æ ·
- **Reward-weighted**: æŒ‰å¥–åŠ±åŠ æƒ
- **Recency-weighted**: æŒ‰æ—¶é—´åŠ æƒ
- **Diversity**: å¤šæ ·æ€§é‡‡æ ·
- **Similarity**: ç›¸ä¼¼åº¦é‡‡æ ·

### 4. å®Œå–„çš„è¯„ä¼°
- **Accuracy**: å‡†ç¡®ç‡è¿½è¸ª
- **Forgetting**: é—å¿˜æµ‹é‡
- **Transfer**: è¿ç§»å­¦ä¹ æ•ˆæœ
- **Per-domain**: åˆ†domainç»Ÿè®¡

---

## ğŸ“ˆ å…¸å‹å·¥ä½œæµç¨‹

### åˆå­¦è€…æµç¨‹ï¼ˆ1å°æ—¶ï¼‰

```bash
# 1. å¿«é€Ÿæµ‹è¯•ï¼ˆ5åˆ†é’Ÿï¼‰
python scripts/quick_experiment.py quick-test --domain airline --num-tasks 10

# 2. æŸ¥çœ‹ç»“æœï¼ˆ5åˆ†é’Ÿï¼‰
tau2 cl-analyze experiments/quick_test_airline/results.json

# 3. é˜…è¯»æ–‡æ¡£ï¼ˆ50åˆ†é’Ÿï¼‰
# é˜…è¯» å¿«é€Ÿå¼€å§‹æŒ‡å—.md
```

### ç ”ç©¶è€…æµç¨‹ï¼ˆ1å¤©ï¼‰

```bash
# 1. å‡†å¤‡æ•°æ®ï¼ˆ30åˆ†é’Ÿï¼‰
tau2 cl-validate-data data/tau2/domains/
tau2 cl-data-requirements --domains airline retail telecom
tau2 cl-generate-splits --domains airline retail telecom --strategy sequential

# 2. è¿è¡Œå¯¹æ¯”å®éªŒï¼ˆ4å°æ—¶ï¼‰
python scripts/quick_experiment.py full --domains airline,retail,telecom --num-tasks 100

# 3. åˆ†æç»“æœï¼ˆ2å°æ—¶ï¼‰
python scripts/compare_experiments.py \
    experiments/icl_er_sequential \
    experiments/prompt_strategy_sequential \
    experiments/baseline

# 4. æ’°å†™æŠ¥å‘Šï¼ˆå‰©ä½™æ—¶é—´ï¼‰
```

---

## ğŸ” å®éªŒç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå¿«é€ŸéªŒè¯æƒ³æ³•

```bash
# ç›®æ ‡ï¼šå¿«é€Ÿæµ‹è¯•ICL-ERåœ¨airline domainä¸Šçš„è¡¨ç°
tau2 cl-run \
    --name quick_test \
    --domains airline \
    --agent-type icl_er \
    --num-tasks 20 \
    --eval-frequency 5
```

### ç¤ºä¾‹2ï¼šå¯¹æ¯”ä¸åŒæ–¹æ³•

```bash
# è¿è¡Œä¸‰ä¸ªæ–¹æ³•å¯¹æ¯”
for agent in icl_er prompt_strategy baseline; do
    tau2 cl-run \
        --name ${agent}_exp \
        --domains airline retail \
        --agent-type $agent \
        --num-tasks 50
done

# å¯¹æ¯”ç»“æœ
python scripts/compare_experiments.py \
    experiments/icl_er_exp \
    experiments/prompt_strategy_exp \
    experiments/baseline_exp
```

### ç¤ºä¾‹3ï¼šæµ‹è¯•ä¸åŒcurriculum

```bash
# æµ‹è¯•sequential vs interleaved
for curriculum in sequential interleaved; do
    tau2 cl-run \
        --name ${curriculum}_exp \
        --domains airline retail \
        --curriculum $curriculum \
        --agent-type icl_er \
        --num-tasks 50
done
```

### ç¤ºä¾‹4ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶

åˆ›å»º `my_config.yaml`:
```yaml
name: "my_experiment"
domains: ["airline", "retail", "telecom"]
curriculum_strategy: "SEQUENTIAL"
agent_type: "ICL_ER"
agent_llm: "gpt-4o-mini"
user_llm: "gpt-4o-mini"
num_tasks_per_domain: 50
eval_frequency: 10
memory_buffer_size: 1000
max_examples_in_prompt: 5
seed: 42
```

è¿è¡Œï¼š
```bash
tau2 cl-run --config my_config.yaml
```

---

## ğŸ“ å­¦ä¹ èµ„æº

### æ–‡æ¡£
1. **å¿«é€Ÿå¼€å§‹æŒ‡å—.md** - æœ€é€‚åˆæ–°æ‰‹ï¼ŒåŒ…å«è¯¦ç»†æ­¥éª¤
2. **CLå®éªŒå¿«é€Ÿå¼€å§‹.md** - å¿«é€Ÿå‚è€ƒå¡
3. **continual_learning_workflow.md** - å®Œæ•´æŠ€æœ¯æ–‡æ¡£

### ç¤ºä¾‹è„šæœ¬
1. **scripts/quick_experiment.py** - åŒ…å«å¤šä¸ªå®ç”¨å‘½ä»¤
2. **demo_commands.sh/bat** - äº¤äº’å¼æ¼”ç¤º

### ä»£ç ç¤ºä¾‹
æŸ¥çœ‹ `src/tau2/continual_learning/` ä¸­çš„å®ç°ä»£ç å’Œæ³¨é‡Šã€‚

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šå‘½ä»¤æ‰¾ä¸åˆ°
```bash
# è§£å†³æ–¹æ¡ˆ
pip install -e .
# æˆ–
python -m tau2.cli cl-run --help
```

### é—®é¢˜2ï¼šå®éªŒå¤ªæ…¢
```bash
# ä½¿ç”¨æ›´å¿«çš„æ¨¡å‹
--agent-llm gpt-4o-mini --user-llm gpt-4o-mini

# å‡å°‘ä»»åŠ¡æ•°
--num-tasks 20

# é™ä½è¯„ä¼°é¢‘ç‡
--eval-frequency 20
```

### é—®é¢˜3ï¼šå†…å­˜ä¸è¶³
```bash
# å‡å°bufferå¤§å°
--buffer-size 500

# å‡å°‘promptä¸­çš„ç¤ºä¾‹æ•°
--max-examples 3
```

### é—®é¢˜4ï¼šæ•°æ®ä¸è¶³
```bash
# ç”Ÿæˆæ›´å¤šä»»åŠ¡æ¨¡æ¿
python scripts/quick_experiment.py generate --domain airline --num-tasks 50

# æˆ–ä½¿ç”¨æ›´å°‘çš„ä»»åŠ¡
--num-tasks 20
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

ç°åœ¨ä½ å¯ä»¥ï¼š

1. **è¿è¡Œç¬¬ä¸€ä¸ªå®éªŒ**
   ```bash
   python scripts/quick_experiment.py quick-test --domain airline --num-tasks 10
   ```

2. **æ¢ç´¢ä¸åŒé…ç½®**
   - å°è¯•ä¸åŒçš„agentç±»å‹
   - æµ‹è¯•ä¸åŒçš„curriculumç­–ç•¥
   - è°ƒæ•´è¶…å‚æ•°

3. **å®ç°è‡ªå®šä¹‰æ–¹æ³•**
   - åœ¨ `src/tau2/continual_learning/agents/` æ·»åŠ æ–°agent
   - åœ¨ `src/tau2/continual_learning/curriculum/` æ·»åŠ æ–°curriculum
   - åœ¨ `src/tau2/continual_learning/metrics/` æ·»åŠ æ–°æŒ‡æ ‡

4. **è¿è¡Œå®Œæ•´å®éªŒ**
   ```bash
   python scripts/quick_experiment.py full --domains airline,retail,telecom --num-tasks 100
   ```

---

## ğŸ“Š é¢„æœŸç»“æœ

åŸºäºåˆæ­¥æµ‹è¯•ï¼Œé¢„æœŸæ€§èƒ½ï¼š

| Method | Average Accuracy | Forgetting Rate | Forward Transfer |
|--------|-----------------|-----------------|------------------|
| ICL-ER | 0.80-0.90 | 0.05-0.15 | 0.03-0.08 |
| Prompt Strategy | 0.75-0.85 | 0.08-0.18 | 0.01-0.05 |
| Baseline | 0.70-0.80 | 0.15-0.25 | -0.02-0.02 |

*æ³¨ï¼šå®é™…ç»“æœå–å†³äºå…·ä½“ä»»åŠ¡ã€domainå’Œè¶…å‚æ•°è®¾ç½®*

---

## âœ… éªŒè¯æ¸…å•

åœ¨å¼€å§‹å®éªŒå‰ï¼Œç¡®ä¿ï¼š

- [ ] å·²å®‰è£…é¡¹ç›®ï¼š`pip install -e .`
- [ ] å·²é…ç½®API keysï¼ˆåœ¨ `.env` æ–‡ä»¶ä¸­ï¼‰
- [ ] æ•°æ®æœ‰æ•ˆï¼š`tau2 cl-validate-data data/tau2/domains/`
- [ ] å‘½ä»¤å¯ç”¨ï¼š`tau2 cl-info`
- [ ] å·²é˜…è¯»å¿«é€Ÿå¼€å§‹æŒ‡å—

---

## ğŸ‰ æ€»ç»“

ä½ ç°åœ¨æ‹¥æœ‰ï¼š

âœ… **å®Œæ•´çš„CLæ¡†æ¶** - ä»æ•°æ®åˆ°è®­ç»ƒåˆ°è¯„ä¼°
âœ… **å¤šç§å®éªŒæ–¹æ³•** - ICL-ER, Prompt Strategy, Baseline
âœ… **çµæ´»çš„å·¥å…·** - CLIå‘½ä»¤ã€Pythonè„šæœ¬ã€é…ç½®æ–‡ä»¶
âœ… **è¯¦ç»†çš„æ–‡æ¡£** - æ–°æ‰‹æ•™ç¨‹ã€æŠ€æœ¯æ–‡æ¡£ã€ä»£ç æ³¨é‡Š
âœ… **å®ç”¨çš„è„šæœ¬** - å¿«é€Ÿå®éªŒã€å¯¹æ¯”åˆ†æã€æ•°æ®ç”Ÿæˆ

**ç«‹å³å¼€å§‹ä½ çš„ç¬¬ä¸€ä¸ªå®éªŒï¼š**

```bash
python scripts/quick_experiment.py quick-test --domain airline --num-tasks 10
```

ç¥å®éªŒé¡ºåˆ©ï¼ğŸš€

---

**é—®é¢˜æˆ–åé¦ˆï¼Ÿ**
- æŸ¥çœ‹æ–‡æ¡£ï¼š`docs/` ç›®å½•
- è¿è¡Œå¸®åŠ©ï¼š`tau2 cl-run --help`
- æŠ¥å‘Šé—®é¢˜ï¼šGitHub Issues
